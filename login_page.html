<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/login.css" />
    <title>기숙사 웹사이트 - 로그인</title>
    <script src="js/login.js" defer></script>
  </head>
  <body>
    <header class="header">
      <div class="inner">
        <h1 class="logo">
          <a href="main_page.html">
            <img src="img/logo.png" alt="기숙사 로고" />
          </a>
        </h1>
        <nav class="gnb">
          <ul>
            <li><a href="login_page.html" class="active">로그인</a></li>
            <li><a href="#">설정</a></li>
            <li><a href="#">공지사항</a></li>
            <li><a href="#">기숙사</a></li>
            <li><a href="#">자취방</a></li>
          </ul>
        </nav>
        <button class="hamburger-menu">
          <img src="img/menu.png" alt="메뉴" />
        </button>
      </div>
    </header>
    <main class="main-content">
      <section class="login-section">
        <div class="login-container">
          <div class="login-header">
            <h2>로그인</h2>
            <p>기숙사 웹사이트에 오신 것을 환영합니다</p>
          </div>
          <div class="login-form-container">
            <form id="loginForm" class="login-form">
              <div class="form-group">
                <label for="userId">아이디</label>
                <input
                  type="text"
                  id="userId"
                  name="userId"
                  placeholder="아이디를 입력하세요"
                  required
                />
              </div>
              <div class="form-group">
                <label for="userPw">비밀번호</label>
                <input
                  type="password"
                  id="userPw"
                  name="userPw"
                  placeholder="비밀번호를 입력하세요"
                  required
                />
              </div>
              <div class="login-options">
                <div class="remember-me">
                  <input type="checkbox" id="rememberMe" name="rememberMe" />
                  <label for="rememberMe">아이디 저장</label>
                </div>
                <div class="find-account">
                  <a href="#">아이디/비밀번호 찾기</a>
                </div>
              </div>
              <button type="submit" class="login-btn">로그인</button>
            </form>
            <div class="login-divider">
              <span>또는</span>
            </div>
            <div class="phone-login">
              <h3>휴대폰 번호로 로그인</h3>
              <form id="phoneForm" class="phone-form">
                <div class="form-group">
                  <label for="phoneNumber">휴대폰 번호</label>
                  <div class="phone-input-group">
                    <input
                      type="tel"
                      id="phoneNumber"
                      name="phoneNumber"
                      placeholder="휴대폰 번호 (- 없이 입력)"
                      pattern="[0-9]{11}"
                      required
                    />
                    <button
                      type="button"
                      id="sendVerificationBtn"
                      class="verification-btn"
                    >
                      인증번호 전송
                    </button>
                  </div>
                </div>
                <div class="form-group verification-code-group hidden">
                  <label for="verificationCode">인증번호</label>
                  <div class="verification-input-group">
                    <input
                      type="text"
                      id="verificationCode"
                      name="verificationCode"
                      placeholder="인증번호 6자리 입력"
                      pattern="[0-9]{6}"
                      maxlength="6"
                      required
                    />
                    <div class="timer" id="verificationTimer">3:00</div>
                    <button
                      type="button"
                      id="verifyCodeBtn"
                      class="verification-btn"
                    >
                      확인
                    </button>
                  </div>
                </div>
                <button
                  type="submit"
                  id="phoneLoginBtn"
                  class="login-btn phone-login-btn hidden"
                >
                  로그인
                </button>
              </form>
            </div>
            <div class="register-link">
              <p>아직 계정이 없으신가요? <a href="#">회원가입</a></p>
            </div>
          </div>
        </div>
      </section>
    </main>
    <footer class="footer">
      <div class="inner">
        <p>&copy; 2025 기숙사 웹사이트. All rights reserved.</p>
        <p>문의: admin@dormitory.com | 전화: 010-1234-5678</p>
      </div>
    </footer>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // 햄버거 메뉴 기능
        const hamburgerMenu = document.querySelector(".hamburger-menu");
        if (hamburgerMenu) {
          hamburgerMenu.addEventListener("click", function () {
            document.querySelector(".gnb").classList.toggle("active");
          });
        }

        // 각 네비게이션 항목 클릭 시 메뉴를 닫음
        document.querySelectorAll(".gnb ul li a").forEach(function (menuItem) {
          menuItem.addEventListener("click", function () {
            document.querySelector(".gnb").classList.remove("active");
          });
        });

        // 로그인 폼 처리
        const loginForm = document.getElementById("loginForm");
        if (loginForm) {
          loginForm.addEventListener("submit", function (e) {
            e.preventDefault();

            const userId = document.getElementById("userId").value;
            const userPw = document.getElementById("userPw").value;

            // 여기서 실제 로그인 로직을 추가하세요
            console.log(`로그인 시도: ${userId}`);

            // 실제 서버 통신은 여기에 구현
            // 예: fetch('/api/login', { method: 'POST', ... })

            // 임시로 알림 표시
            alert("로그인 성공!");

            // 성공 시 메인 페이지로 리디렉션
            window.location.href = "main_page.html";
          });
        }

        // 휴대폰 인증 관련 요소
        const sendVerificationBtn = document.getElementById(
          "sendVerificationBtn"
        );
        const verifyCodeBtn = document.getElementById("verifyCodeBtn");
        const phoneLoginBtn = document.getElementById("phoneLoginBtn");
        const verificationCodeGroup = document.querySelector(
          ".verification-code-group"
        );
        const phoneForm = document.getElementById("phoneForm");

        // 인증번호 전송 버튼 클릭 이벤트
        if (sendVerificationBtn) {
          sendVerificationBtn.addEventListener("click", function () {
            const phoneNumber = document.getElementById("phoneNumber").value;

            // 휴대폰 번호 유효성 검사
            if (!/^01[016789]\d{7,8}$/.test(phoneNumber)) {
              alert("유효한 휴대폰 번호를 입력해주세요.");
              return;
            }

            // 인증번호 전송 로직 (실제로는 서버에 요청)
            console.log(`인증번호 전송: ${phoneNumber}`);

            // 성공 시 인증번호 입력 필드 표시
            verificationCodeGroup.classList.remove("hidden");

            // 인증번호 타이머 시작
            startVerificationTimer();

            // 버튼 텍스트 변경
            sendVerificationBtn.textContent = "재전송";

            // 임시로 알림 표시
            alert(`${phoneNumber}로 인증번호가 전송되었습니다.`);
          });
        }

        // 인증번호 확인 버튼 클릭 이벤트
        if (verifyCodeBtn) {
          verifyCodeBtn.addEventListener("click", function () {
            const verificationCode =
              document.getElementById("verificationCode").value;

            // 인증번호 유효성 검사
            if (!/^\d{6}$/.test(verificationCode)) {
              alert("6자리 숫자를 입력해주세요.");
              return;
            }

            // 인증번호 확인 로직 (실제로는 서버에 확인 요청)
            console.log(`인증번호 확인: ${verificationCode}`);

            // 성공 시 로그인 버튼 활성화
            phoneLoginBtn.classList.remove("hidden");

            // 타이머 중지
            clearInterval(timerInterval);
            document.getElementById("verificationTimer").textContent =
              "인증완료";

            // 임시로 알림 표시
            alert("인증이 완료되었습니다.");
          });
        }

        // 휴대폰 로그인 폼 제출 이벤트
        if (phoneForm) {
          phoneForm.addEventListener("submit", function (e) {
            e.preventDefault();

            const phoneNumber = document.getElementById("phoneNumber").value;

            // 여기서 실제 로그인 로직을 추가하세요
            console.log(`휴대폰 로그인 시도: ${phoneNumber}`);

            // 실제 서버 통신은 여기에 구현
            // 예: fetch('/api/phone-login', { method: 'POST', ... })

            // 임시로 알림 표시
            alert("로그인 성공!");

            // 성공 시 메인 페이지로 리디렉션
            window.location.href = "main_page.html";
          });
        }

        // 타이머 관련 변수
        let timerInterval;
        let timeLeft = 180; // 3분

        // 인증번호 타이머 시작 함수
        function startVerificationTimer() {
          // 이전 타이머가 있으면 중지
          if (timerInterval) {
            clearInterval(timerInterval);
          }

          // 타이머 초기화
          timeLeft = 180;
          updateTimerDisplay();

          // 타이머 시작
          timerInterval = setInterval(function () {
            timeLeft--;
            updateTimerDisplay();

            if (timeLeft <= 0) {
              clearInterval(timerInterval);
              alert("인증 시간이 만료되었습니다. 다시 시도해주세요.");
            }
          }, 1000);
        }

        // 타이머 표시 업데이트 함수
        function updateTimerDisplay() {
          const minutes = Math.floor(timeLeft / 60);
          const seconds = timeLeft % 60;
          document.getElementById(
            "verificationTimer"
          ).textContent = `${minutes}:${seconds < 10 ? "0" : ""}${seconds}`;
        }
      });
    </script>
  </body>
</html>
